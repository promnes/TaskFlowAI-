# ุฏููู ุงุฎุชุจุงุฑ ุงูุชุทุจูู - APPLICATION TESTING GUIDE

## ๐งช ุงุฎุชุจุงุฑ ุงููููุฒุงุช ุงููุทุจูุฉ

### ุงูุฅุนุฏุงุฏ ุงูุฃููู

#### 1. **ุชุดุบูู ุงูุจูุช**
```bash
python bot.py
```

#### 2. **ุงูุชุญูู ูู ุงูุงุชุตุงู**
```
/start
```

**ุงููุชููุน**: ุงูุชุฑุญูุจ ูุงูุทูุจ ููุดุงุฑูุฉ ุฑูู ุงููุงุชู

---

## โ ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### 1. ูุธุงู ุงูุชุญูู ูู ุงูุฑููุฒ (Verification Code System)

**ุงูุฎุทูุงุช**:
1. ุงุฎุชุฑ `๐ธ ุณุญุจ`
2. ุฃุฏุฎู ุงููุจูุบ (ูุซุงู: 500)
3. ูุฌุจ ุฃู ุชุณุชูุจู ุฑูุฒ 4 ุฃุฑูุงู
4. ุฃุฏุฎู ุฑูุฒ ุฎุงุทุฆ 3 ูุฑุงุช
5. ุชุญูู ูู ุงูุฅูุบุงุก ุงูุชููุงุฆู

**ุงูุงุฎุชุจุงุฑุงุช**:
- [ ] ุงูุฑูุฒ ูุชู ุชูููุฏู ุนุดูุงุฆูุงู
- [ ] ุงูุฑูุฒ ูุธูุฑ ูู ุงูุฑุณุงูุฉ
- [ ] ูุธูุฑ ุชุญุฐูุฑ "5 ุฏูุงุฆู" ุงูุชูุงุก ุงูุตูุงุญูุฉ
- [ ] ูุญุงููุฉ ุฎุงุทุฆุฉ ุชุธูุฑ ุนุฏุฏ ุงููุญุงููุงุช ุงููุชุจููุฉ
- [ ] 3 ูุญุงููุงุช ุฎุงุทุฆุฉ ุชุคุฏู ูุฅูุบุงุก ุงูุนูููุฉ
- [ ] ุงูุฑูุฒ ุงูุตุญูุญ ููููู ูุฎุทูุฉ ุงูุชุฃููุฏ

**ููุฏ ุงูุงุฎุชุจุงุฑ**:
```python
# ูุญุงูุงุฉ ุงููุญุงููุงุช ุงูุฎุงุทุฆุฉ
async def test_verification_code(session_maker):
    # ุฅูุดุงุก ุนูููุฉ ุณุญุจ
    # ุฅุฏุฎุงู 3 ุฑููุฒ ุฎุงุทุฆุฉ
    # ุงูุชุญูู ูู ุงูุฅูุบุงุก ุงูุชููุงุฆู
    pass
```

---

### 2. ูุธุงู ุงูุนูุงููู ุงููุญููุธุฉ (Saved Addresses)

**ุงูุฎุทูุงุช**:
1. ูู ุงูุณุญุจุ ุงุฎุชุฑ `ุงูุนูุงููู ุงููุญููุธุฉ`
2. ูุง ูุฌุจ ุฃู ุชููู ููุงู ุนูุงููู ูู ุงูุจุฏุงูุฉ
3. ุงุฎุชุฑ `ุฅุถุงูุฉ ุนููุงู ุฌุฏูุฏ`
4. ุฃุฏุฎู ุนููุงู (ูุซุงู: "123 ุดุงุฑุน ุงููููุ ุงูุฑูุงุถ")
5. ุฃุถู ุชุณููุฉ (ูุซุงู: "ุงูุจูู ุงูุฃููู")
6. ุฃูุฏ ุงูุญูุธ
7. ุงูุนูุฏุฉ ูุงุฎุชุฑ ููุณ ุงูุนููุงู

**ุงูุงุฎุชุจุงุฑุงุช**:
- [ ] ูุง ุชูุฌุฏ ุนูุงููู ูู ุงูุจุฏุงูุฉ
- [ ] ุฅุถุงูุฉ ุนููุงู ุฌุฏูุฏ ูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุงูุนููุงู ูุธูุฑ ูู ุงููุงุฆูุฉ ุนูุฏ ุงูุนูุฏุฉ
- [ ] ูููู ุงุฎุชูุงุฑ ุนููุงู ูุญููุธ ูุจุงุดุฑุฉ
- [ ] ุนุฏุฏ ูุญุงููุงุช ุงูุฅุถุงูุฉ ุชุนูู ุจุดูู ุตุญูุญ
- [ ] ุงูุชุณููุฉ ุชุธูุฑ ุจุฌุงูุจ ุงูุนููุงู

**ุงุณุชุนูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช**:
```sql
SELECT * FROM withdrawal_addresses WHERE user_id = ?;
```

---

### 3. ูุธุงู ุงุฎุชูุงุฑ ุงูุนููุฉ (Currency Selection)

**ุงูุฎุทูุงุช**:
1. ุงุฎุชุฑ `๐ฑ ุงูุนููุฉ` (ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ)
2. ุงุฎุชุฑ ุนููุฉ ูุฎุชููุฉ (ูุซูุงู `USD`)
3. ูุฌุจ ุฃู ุชุฑู ุงูุญุฏูุฏ ุงูุฌุฏูุฏุฉ
4. ุชุญูู ูู ุงูุชุญููู ููุฅูุฏุงุน ูุงูุณุญุจ

**ุงูุงุฎุชุจุงุฑุงุช**:
- [ ] 4 ุนููุงุช ูุชุงุญุฉ
- [ ] ุญุฏูุฏ ูุฎุชููุฉ ููู ุนููุฉ
- [ ] ุงูุญุฏูุฏ ุชุชุบูุฑ ุนูุฏ ุชุบููุฑ ุงูุนููุฉ
- [ ] ุงูุชูุถูู ูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุงูุญุฏูุฏ ุชุนุฑุถ ุงูุฑููุฒ ุงูุตุญูุญุฉ (๏ทผุ $ุ โฌุ ุฏ.ุฅ)

**ุฌุฏูู ุงูุญุฏูุฏ**:
```
SAR:  50-10,000 (ุฅูุฏุงุน), 100-10,000 (ุณุญุจ)
USD:  10-2,000, 20-2,000
EUR:  8-1,500, 15-1,500
AED:  180-36,000, 350-36,000
```

**ุงูุชุญูู**:
```python
assert get_currency_limits('SAR', 'deposit') == (50, 10000)
assert get_currency_limits('USD', 'withdraw') == (20, 2000)
```

---

### 4. ุนุฑุถ ุงูุทูุจุงุช ุงูุฎุงุตุฉ ุจู (My Requests)

**ุงูุฎุทูุงุช**:
1. ุจุนุฏ ุนุฏุฉ ุนูููุงุช ุฅูุฏุงุน/ุณุญุจุ ุงุฎุชุฑ `๐ ุทูุจุงุชู`
2. ูุฌุจ ุฃู ุชุฑู ุขุฎุฑ 20 ุทูุจ
3. ุงุฎุชุฑ ุงูุชุตููุฉ ุญุณุจ ุงูุญุงูุฉ:
   - โณ ุงูุทูุจุงุช ุงููุนููุฉ
   - โ ุงูุทูุจุงุช ุงูููุงูู ุนูููุง
   - โ ุงูุทูุจุงุช ุงููุฑููุถุฉ
   - ๐ ุฌููุน ุงูุทูุจุงุช

**ุงูุงุฎุชุจุงุฑุงุช**:
- [ ] ุงูุนุฑุถ ุงูุงูุชุฑุงุถู ูุธูุฑ ุขุฎุฑ 20 ุทูุจ
- [ ] ุงูุชุตููุฉ ุชุนูู ููู ุญุงูุฉ
- [ ] ุชุธูุฑ ูุนูููุงุช ูุงููุฉ (ุฑููุ ูุจูุบุ ุชุงุฑูุฎ)
- [ ] ุงูุชุฑุชูุจ ูู ุงูุฃุญุฏุซ ุฅูู ุงูุฃูุฏู
- [ ] ุฑุณุงูุฉ ุนูุฏ ุนุฏู ูุฌูุฏ ุทูุจุงุช

**ุงุณุชุนูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช**:
```sql
SELECT * FROM outbox 
WHERE user_id = ? AND status = 'PENDING'
ORDER BY created_at DESC 
LIMIT 20;
```

---

### 5. ููู ุงููุณุชุฎุฏู (User Profile)

**ุงูุฎุทูุงุช**:
1. ุงุฎุชุฑ `๐ค ุญุณุงุจู`
2. ูุฌุจ ุฃู ุชุดุงูุฏ:
   - ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ
   - ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ
   - ุงูุฅุญุตุงุฆูุงุช
3. ุงุฎุชุจุฑ ูู ุฎูุงุฑ:
   - ุชุบููุฑ ุงููุบุฉ
   - ุชุบููุฑ ุงูุนููุฉ
   - ุฅุนุงุฏุฉ ุชุนููู
   - ุชุณุฌูู ุฎุฑูุฌ

**ุงูุงุฎุชุจุงุฑุงุช**:
- [ ] ุนุฑุถ ุงูุจูุงูุงุช ุงูุตุญูุญุฉ
- [ ] ุชุบููุฑ ุงููุบุฉ ูุญูุธ ุงูุชูุถูู
- [ ] ุงูุฅุญุตุงุฆูุงุช ุตุญูุญุฉ
- [ ] ุฅุนุงุฏุฉ ุงูุชุนููู ุชูุณุญ ุงูุญุงูุฉ
- [ ] ุชุณุฌูู ุงูุฎุฑูุฌ ูุนูุฏ ูููุทุฉ ุงูุจุฏุงูุฉ
- [ ] ุงูุฑุตูุฏ ูุงููุฌุงููุน ุชุญุณุจ ุจุดูู ุตุญูุญ

**ุงูุชุญูู ูู ุงูุฅุญุตุงุฆูุงุช**:
```python
count_deposits = db.query(Outbox).filter(
    Outbox.user_id == user_id,
    Outbox.type == 'deposit'
).count()

total_deposited = db.query(func.sum(Outbox.amount)).filter(
    Outbox.user_id == user_id,
    Outbox.type == 'deposit'
).scalar() or 0
```

---

### 6. ูุธุงู ุงูุดูุงูู (Complaint System)

**ุงูุฎุทูุงุช**:
1. ุงุฎุชุฑ `๐ ุงูุฏุนู`
2. ุงุฎุชุฑ `๐ ุดููู ุฌุฏูุฏุฉ`
3. ุงุฎุชุฑ ููุน ุงูุดููู (7 ุฃููุงุน ูุชุงุญุฉ)
4. ุงูุชุจ ุชูุงุตูู (10 ุฃุญุฑู ุนูู ุงูุฃูู)
5. ุฃูุฏ ุงูุดููู
6. ุชุญูู ูู ุฑูู ุงูุดููู ุงูุฌุฏูุฏ

**ุงูุงุฎุชุจุงุฑุงุช**:
- [ ] 7 ุฃููุงุน ุดูุงูู ูุชุงุญุฉ
- [ ] ุงูุชูุงุตูู ุชุญุชุงุฌ 10 ุฃุญุฑู ุนูู ุงูุฃูู
- [ ] ุงูุดููู ุชุญูุธ ุจุฑูู ูุฑูุฏ
- [ ] ุงูุญุงูุฉ ุงูุฃูููุฉ = PENDING
- [ ] ุนุฑุถ ุงูุดูุงูู ุงูุณุงุจูุฉ ูุนูู
- [ ] ุนุฏุฏ ุงูุดูุงูู ูุญุฏุซ ุจุดูู ุตุญูุญ

**ูุซุงู ุงูุชูุงุตูู**:
```python
complaint = {
    'type': 'complaint',
    'complaint_type': 'deposit_issue',
    'complaint_details': 'ุชู ุชุญููู ุงููุจูุบ ูููู ูู ููุฌุฏ ูู ุงูุญุณุงุจ',
    'submitted_at': '2025-01-22T10:30:00'
}
```

---

## ๐ ุงุฎุชุจุงุฑุงุช ุงูุนูู (Deep Testing)

### ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช

```python
async def test_database_integrity():
    """ุงุฎุชุจุงุฑ ุณูุงูุฉ ุงูุจูุงูุงุช"""
    async with session_maker() as session:
        # ุงูุชุญูู ูู ูุฌูุฏ ุฌุฏุงูู ุฌุฏูุฏุฉ
        inspector = inspect(engine)
        tables = inspector.get_table_names()
        
        assert 'withdrawal_addresses' in tables
        assert 'outbox' in tables
        
        # ุงูุชุญูู ูู ุงูุฃุนูุฏุฉ
        address_columns = [c['name'] for c in 
                          inspector.get_columns('withdrawal_addresses')]
        assert 'address' in address_columns
        assert 'label' in address_columns
        assert 'is_active' in address_columns
```

### ุงุฎุชุจุงุฑ ุงูุญุงูุงุช (FSM Testing)

```python
async def test_fsm_states():
    """ุงุฎุชุจุงุฑ ุงูุชูุงูุงุช ุงูุญุงูุงุช"""
    from handlers.financial_operations import WithdrawalFlow
    from handlers.addresses import AddressFlow
    from handlers.support import ComplaintFlow
    
    # ุงูุชุญูู ูู ูุฌูุฏ ุงูุญุงูุงุช
    assert hasattr(WithdrawalFlow, 'verify_code')
    assert hasattr(AddressFlow, 'select_address')
    assert hasattr(ComplaintFlow, 'select_type')
```

### ุงุฎุชุจุงุฑ ุงูุฃูุงู

```python
async def test_security():
    """ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู"""
    
    # 1. ุงุฎุชุจุงุฑ ูุญุงููุงุช ุงูุฑูุฒ ุงููุญุฏูุฏุฉ
    async with session_maker() as session:
        # ูุญุงูุงุฉ 4 ูุญุงููุงุช ุฎุงุทุฆุฉ
        # ุงูุชุญูู ูู ุงูุฅูุบุงุก ุจุนุฏ 3
        pass
    
    # 2. ุงุฎุชุจุงุฑ ุงูุชุญูู ูู ุงููุตูู
    async with session_maker() as session:
        # ูุญุงููุฉ ุงููุตูู ูุนูุงููู ูุณุชุฎุฏู ุขุฎุฑ
        # ูุฌุจ ุฃู ุชูุดู
        pass
```

---

## ๐ ูุนุงููุฑ ุงููุฌุงุญ

| ุงููููุฒุฉ | ุงููุนูุงุฑ | ุงููุฒู |
|-------|-------|------|
| ุงูุชุญูู ูู ุงูุฑููุฒ | 3 ูุญุงููุงุช + ุฅูุบุงุก | 20% |
| ุงูุนูุงููู ุงููุญููุธุฉ | ุงูุญูุธ ูุงูุงุณุชุฑุฌุงุน | 20% |
| ุงุฎุชูุงุฑ ุงูุนููุฉ | 4 ุนููุงุช ุตุญูุญุฉ | 15% |
| ุนุฑุถ ุงูุทูุจุงุช | ุงูุชุตููุฉ ูุงูุนุฑุถ | 15% |
| ููู ุงููุณุชุฎุฏู | ุงูุจูุงูุงุช ุงูุตุญูุญุฉ | 15% |
| ูุธุงู ุงูุดูุงูู | ุงูุชูุฏูู ูุงูุชุชุจุน | 15% |

**ุงููุฌุงุญ ุงูุฅุฌูุงูู**: 100% ูู ุงูุงุฎุชุจุงุฑุงุช

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "Module not found"
```bash
# ุงูุชุญูู ูู ุงูุงุณุชูุฑุงุฏุงุช
grep -r "from handlers import" bot.py
# ูุฌุจ ุฃู ุชุดูู: currency, addresses, requests, profile, support
```

### ุฎุทุฃ: "Table not found"
```bash
# ุชุดุบูู ุงูุชุฑููุงุช
alembic upgrade head
```

### ุฎุทุฃ: "Foreign key constraint"
```sql
-- ุงูุชุญูู ูู ุงูููุงุชูุญ ุงูุฃุฌูุจูุฉ
PRAGMA foreign_keys = ON;
SELECT * FROM withdrawal_addresses;
```

### ุฎุทุฃ: "Async context"
```python
# ุงูุชุฃูุฏ ูู ุงุณุชุฎุฏุงู async with
async with session_maker() as session:
    # ุงูููุฏ ููุง
```

---

## ๐ ููุงุญุธุงุช ุงูุงุฎุชุจุงุฑ

1. **ุงูุชูููุช**: ุงุฎุชุจุฑ ุงูุตูุงุญูุฉ ููุฏุฉ 5 ุฏูุงุฆู
2. **ุงูุฃุฑูุงู ุงูุนุดูุงุฆูุฉ**: ุชุญูู ูู ุนุฏู ุงูุชูุฑุงุฑ
3. **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ูุธู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุจุนุฏ ุงูุงูุชูุงุก
4. **ุงูุฑุณุงุฆู**: ุชุญูู ูู ุตุญุฉ ุงููุตูุต ุงูุนุฑุจูุฉ
5. **ุงูุฃููููุงุช**: ุชุญูู ูู ุนุฑุถูุง ุจุดูู ุตุญูุญ

---

## โ ูุงุฆูุฉ ุงููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ

### ูุจู ุงูุฅุทูุงู
- [ ] ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ุชูุฑ ุจูุฌุงุญ
- [ ] ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูุณุฌูุงุช
- [ ] ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุนูู ุจุดูู ุตุญูุญ
- [ ] ุงูุฑุณุงุฆู ุจุงูุนุฑุจูุฉ ุตุญูุญุฉ
- [ ] ุงูุญุฏูุฏ ุงููุตูู ุชุนูู ุจุดูู ุตุญูุญ
- [ ] ุงูุฃูุงู ูุทุจู ุจุดูู ุตุญูุญ

### ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ
- [ ] ุงูุชุญูู ูู ูู ูุณุงุฑ ูู ุงูุชุทุจูู
- [ ] ูุญุงููุฉ ูุณุฑ ูู ููุฒุฉ
- [ ] ุงุฎุชุจุงุฑ ุงูุญุงูุงุช ุงูุญุฏูุฉ
- [ ] ุชุชุจุน ุงูุฃุฎุทุงุก ูุงูุญููู

### ุจุนุฏ ุงููุดุฑ
- [ ] ูุฑุงูุจุฉ ุงูุณุฌูุงุช ุจูุดุงุท
- [ ] ุงูุงุณุชูุงุน ูุฑุฏูุฏ ุงููุณุชุฎุฏููู
- [ ] ุฅุตูุงุญ ุงูุฃุฎุทุงุก ุงูููุชุดูุฉ
- [ ] ุชุญุฏูุซ ุงููุซุงุฆู

---

**ุงูุชุงุฑูุฎ**: 2025-01-22
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ
**ุงูููุงุญุธุงุช**: ุงูุธุฑ ุฅูู IMPLEMENTATION_UPDATE.md ููุชูุงุตูู
